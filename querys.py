# modulo de consultas a la base de datos
def get_all_tc():
    return """
SELECT *
FROM (
SELECT 'IPV' tipo,
id, base, fecha_transaccion, chofer, ronda, fecha_realizacion, hora_realizacion, patente, lugar, "Instructor", motivo, 
"1_fit_for_duty" AS P1, "1_observacion" AS P1_obs, "2_trailer_correcto_para_el_servicio" AS P2, "2_observacion" AS P2_obs, "3_disponibilidad_formulario_defecto" AS P3, "3_observacion" AS P3_obs, "4_tapas_superiores" AS P4, "4_observacion" AS P4_obs, "5_quinta_rueda_palanca_trabada" AS P5, "5_observacion" AS P5_obs, "6_estado_cubiertas" AS P6, "6_observacion" AS P6_obs, "7_imagen_camion" AS P7, "7_observacion" AS P7_obs, "8_instalacion_electrica" AS P8, "8_observacion" AS P8_obs, "9_carteles_sustancias_peligrosas" AS P9, "9_observacion" AS P9_obs, "10_extintores" AS P10, "10_observacion" AS P10_obs, "11_conos_seguridad" AS P11, "11_observacion" AS P11_obs, "12_lineas_trailer" AS P12, "12_observacion" AS P12_obs, "13_niveles_fluidos" AS P13, "13_observacion" AS P13_obs, "14_perdida_fluidos" AS P14, "14_observacion" AS P14_obs, "15_tanque_aire_comprimido" AS P15, "15_observacion" AS P15_obs, "16_existencia_producto" AS P16, "16_observacion" AS P16_obs, "17_perdida_producto" AS P17, "17_observacion" AS P17_obs, "18_cds_vs_producto_api" AS P18, "18_observacion" AS P18_obs, "19_mangueras" AS P19, "19_observacion" AS P19_obs, "20_objetos_sueltos" AS P20, "20_observacion" AS P20_obs, "21_epp" AS P21, "21_observacion" AS P21_obs, "22_luces" AS P22, "22_observacion" AS P22_obs, "23_freno" AS P23, "23_observacion" AS P23_obs, "24_freno_mano" AS P24, "24_observacion" AS P24_obs, "25_alarma_retroceso" AS P25, "25_observacion" AS P25_obs, "26_nivel_combustible" AS P26, "26_observacion" AS P26_obs, "27_extintor_cabina" AS P27, "27_observacion" AS P27_obs, "28_kite_emergencia_derrames" AS P28, "28_observacion" AS P28_obs, "29_arnes_anticaida" AS P29, "29_observacion" AS P29_obs, "30_balizas" AS P30, "30_observacion" AS P30_obs, "31_cable_puesta_tierra" AS P31, "31_observacion" AS P31_obs, "32_documentacion_camion" AS P32, "32_observacion" AS P32_obs, "33_tarjeta_sitio" AS P33, "33_observacion" AS P33_obs, "34_disponibilidad_formularios" AS P34, "34_observacion" AS P34_obs, "35_guia_emergencia" AS P35, "35_observacion" AS P35_obs, "36_manual_conductor" AS P36, "36_observacion" AS P36_obs, "37_formulario_ipv" AS P37, "37_observacion" AS P37_obs, "38_telefono_celular" AS P38, "38_observacion" AS P38_obs, "39_cinturon_seguridad" AS P39, "39_observacion" AS P39_obs, "40_limpiaparabrisas_bocina" AS P40, "40_observacion" AS P40_obs, "41_espejos" AS P41, "41_observacion" AS P41_obs, "42_pregunta" AS P42, "42_observacion" AS P42_obs, "43_pregunta" AS P43, "43_observacion" AS P43_obs, "44_pregunta" AS P44, "44_observacion" AS P44_obs, "45_pregunta" AS P45, "45_observacion" AS P45_obs, "46_pregunta" AS P46, "46_observacion" AS P46_obs, "47_pregunta" AS P47, "47_observacion" AS P47_obs, "48_pregunta" AS P48, "48_observacion" AS P48_obs, "49_pregunta" AS P49, "49_observacion" AS P49_obs, "50_pregunta" AS P50, "50_observacion" AS P50_obs, "51_pregunta" AS P51, "51_observacion" AS P51_obs, "52_pregunta" AS P52, "52_observacion" AS P52_obs, "53_pregunta" AS P53, "53_observacion" AS P53_obs, "54_pregunta" AS P54, "54_observacion" AS P54_obs, "55_pregunta" AS P55, "55_observacion" AS P55_obs, "56_pregunta" AS P56, "56_observacion" AS P56_obs, "57_pregunta" AS P57, "57_observacion" AS P57_obs, 
puntaje, estado, empresa_chofer, legajo_chofer, pregunta_13_principios, 13_princ_observacion, hora_inicio, hora_fin, adicional_ipv, retro_a, retro_b, retro_c, retro_d, retro_e, retro_f, retro_g, retro_h, retro_e_obs, retro_f_obs, retro_e_option, retro_f_option
FROM public.tc_axion_ipv

UNION ALL

SELECT 'MANEJO',
id, base, fecha_transaccion, chofer, ronda, fecha_realizacion, hora_realizacion, patente, lugar, "Instructor", motivo, 
"1_usa_cinturon_siempre" AS P1, "1_observacion" AS P1_obs, "2_util_3_puntos_ing_egr_manos" AS P2, "2_observacion" AS P2_obs, "3_mant_cabina_libre" AS P3, "3_observacion" AS P3_obs, "4_util_luc_bajas" AS P4, "4_observacion" AS P4_obs, "5_descansa_15_fatiga" AS P5, "5_observacion" AS P5_obs, "6_apaga_cel_iniciar" AS P6, "6_observacion" AS P6_obs, "7_evalua_entrada_salida" AS P7, "7_observacion" AS P7_obs, "8_circula_detiene_hoja_sitio" AS P8, "8_observacion" AS P8_obs, "9_limite_velocidad_carteles" AS P9, "9_observacion" AS P9_obs, "10_espera_porton_antes" AS P10, "10_observacion" AS P10_obs, "11_adapta_condiciones_trafico" AS P11, "11_observacion" AS P11_obs, "12_detiene_visibilidad_maniobrar" AS P12, "12_observacion" AS P12_obs, "13_vehiculos_delante_antes_marcha" AS P13, "13_observacion" AS P13_obs, "14_cede_paso_vehiculos" AS P14, "14_observacion" AS P14_obs, "15_mant_distancia_6" AS P15, "15_observacion" AS P15_obs, "16_aplica_concepto_velocidad" AS P16, "16_observacion" AS P16_obs, "17_analiza_anticipa_ruta" AS P17, "17_observacion" AS P17_obs, "18_control_espejos_5" AS P18, "18_observacion" AS P18_obs, "19_no_mantiene_vista_fija" AS P19, "19_observacion" AS P19_obs, "20_mantiene_lugar_seguridad" AS P20, "20_observacion" AS P20_obs, "21_util_giros_control_espejos" AS P21, "21_observacion" AS P21_obs, "22_uso_bocina_peatones" AS P22, "22_observacion" AS P22_obs, "23_observa_carril_menor_resistencia" AS P23, "23_observacion" AS P23_obs, "24_atento_señales" AS P24, "24_observacion" AS P24_obs, "25_controla_anticipa_retorno" AS P25, "25_observacion" AS P25_obs, "26_ajusta_vel_freno" AS P26, "26_observacion" AS P26_obs, "27_mant_distancia_doblar" AS P27, "27_observacion" AS P27_obs, "28_contr_espejos_doblar" AS P28, "28_observacion" AS P28_obs, "29_anticipa_giros_vehiculos" AS P29, "29_observacion" AS P29_obs, "30_util_señales_antes_durante" AS P30, "30_observacion" AS P30_obs, "31_ajusta_vel_paso_nivel" AS P31, "31_observacion" AS P31_obs, "32_util_ruta_autorizada" AS P32, "32_observacion" AS P32_obs, "33_sigue_hoja_ruta" AS P33, "33_observacion" AS P33_obs, "34_analiza_ingreso_sitio" AS P34, "34_observacion" AS P34_obs, "35_ayuda_hombre_guia" AS P35, "35_observacion" AS P35_obs, NULL AS P36, NULL AS P36_obs, NULL AS P37, NULL AS P37_obs, NULL AS P38, NULL AS P38_obs, NULL AS P39, NULL AS P39_obs, NULL AS P40, NULL AS P40_obs, NULL AS P41, NULL AS P41_obs, NULL AS P42, NULL AS P42_obs, NULL AS P43, NULL AS P43_obs, NULL AS P44, NULL AS P44_obs, NULL AS P45, NULL AS P45_obs, NULL AS P46, NULL AS P46_obs, NULL AS P47, NULL AS P47_obs, NULL AS P48, NULL AS P48_obs, NULL AS P49, NULL AS P49_obs, NULL AS P50, NULL AS P50_obs, NULL AS P51, NULL AS P51_obs, NULL AS P52, NULL AS P52_obs, NULL AS P53, NULL AS P53_obs, NULL AS P54, NULL AS P54_obs, NULL AS P55, NULL AS P55_obs, NULL AS P56, NULL AS P56_obs, NULL AS P57, NULL AS P57_obs, 
puntaje, estado, empresa_chofer, legajo_chofer, pregunta_13_principios, 13_princ_observacion, hora_inicio, hora_fin, adicional_ipv, retro_a, retro_b, retro_c, retro_d, retro_e, retro_f, retro_g, retro_h, retro_e_obs, retro_f_obs, retro_e_option, retro_f_option
FROM public.tc_axion_manejo

UNION ALL

SELECT 'DESCARGA',
id, base, fecha_transaccion, chofer, ronda, fecha_realizacion, hora_realizacion, patente, lugar, "Instructor", motivo, 
"1_asegura_ingreso_hoja_sitio" AS P1, "1_observacion" AS P1_obs, "2_estaciona_correctamente" AS P2, "2_observacion" AS P2_obs, "3_verifica_lugar_correcto" AS P3, "3_observacion" AS P3_obs, "4_sale_entra_3_apoyo" AS P4, "4_observacion" AS P4_obs, "5_epp" AS P5, "5_observacion" AS P5_obs, "6_tacos_antichispa" AS P6, "6_observacion" AS P6_obs, "7_desconecta_bateria" AS P7, "7_observacion" AS P7_obs, "8_controla_peligros" AS P8, "8_observacion" AS P8_obs, "9_verifica_manguera" AS P9, "9_observacion" AS P9_obs, "10_6_conos" AS P10, "10_observacion" AS P10_obs, "11_seg_camionkit" AS P11, "11_observacion" AS P11_obs, "12_responsable_sitio" AS P12, "12_observacion" AS P12_obs, "13_carteleria" AS P13, "13_observacion" AS P13_obs, "14_puesto_tierra" AS P14, "14_observacion" AS P14_obs, "15_controla_cisterna" AS P15, "15_observacion" AS P15_obs, "16_completa_cds" AS P16, "16_observacion" AS P16_obs, "17_abre_API" AS P17, "17_observacion" AS P17_obs, "18_abre_valvulas_fondo" AS P18, "18_observacion" AS P18_obs, "19_llave_master" AS P19, "19_observacion" AS P19_obs, "20_toma_muestra" AS P20, "20_observacion" AS P20_obs, "21_asegura_bocas_descarga" AS P21, "21_observacion" AS P21_obs, "22_controla_identi_tanques" AS P22, "22_observacion" AS P22_obs, "23_aplica_dcc" AS P23, "23_observacion" AS P23_obs, "24_chequea_baldes" AS P24, "24_observacion" AS P24_obs, "25_postura_correcta" AS P25, "25_observacion" AS P25_obs, "26_controla_equipos_descarga" AS P26, "26_observacion" AS P26_obs, "27_manguera_vapores" AS P27, "27_observacion" AS P27_obs, "28_destapa_API" AS P28, "28_observacion" AS P28_obs, "29_sigue_plan_cds" AS P29, "29_observacion" AS P29_obs, "30_doble_chequeo" AS P30, "30_observacion" AS P30_obs, "31_solicita_autoriza" AS P31, "31_observacion" AS P31_obs, "32_prueba_valvula_pie" AS P32, "32_observacion" AS P32_obs, "33_abre_valvula_pie" AS P33, "33_observacion" AS P33_obs, "34_vista_tarea" AS P34, "34_observacion" AS P34_obs, "35_controla_perdidas" AS P35, "35_observacion" AS P35_obs, "36_verifica_vacio" AS P36, "36_observacion" AS P36_obs, "37_descarga_simultanea" AS P37, "37_observacion" AS P37_obs, "38_cierra_API" AS P38, "38_observacion" AS P38_obs, "39_valvula_fondo" AS P39, "39_observacion" AS P39_obs, "40_drena_producto" AS P40, "40_observacion" AS P40_obs, "41_tapa_API" AS P41, "41_observacion" AS P41_obs, "42_guarda_camionkit" AS P42, "42_observacion" AS P42_obs, "43_mide_volumenes" AS P43, "43_observacion" AS P43_obs, "44_info_posterior" AS P44, "44_observacion" AS P44_obs, "45_firma_documentos" AS P45, "45_observacion" AS P45_obs, "46_completa_udcr" AS P46, "46_observacion" AS P46_obs, "47_cierra_cajon_API" AS P47, "47_observacion" AS P47_obs, "48_vuelta_camion" AS P48, "48_observacion" AS P48_obs, "49_sube_3_apoyo" AS P49, "49_observacion" AS P49_obs, "50_apaga_celular" AS P50, "50_observacion" AS P50_obs, "51_retiro_hoja_sitio" AS P51, "51_observacion" AS P51_obs, "52_cliente_descarga" AS P52, "52_observacion" AS P52_obs, "53_espera_10" AS P53, "53_observacion" AS P53_obs, "54_control_aviacion" AS P54, "54_observacion" AS P54_obs, NULL AS P55, NULL AS P55_obs, NULL AS P56, NULL AS P56_obs, NULL AS P57, NULL AS P57_obs, 
puntaje, estado, empresa_chofer, legajo_chofer, pregunta_13_principios, 13_princ_observacion, hora_inicio, hora_fin, adicional_ipv, retro_a, retro_b, retro_c, retro_d, retro_e, retro_f, retro_g, retro_h, retro_e_obs, retro_f_obs, retro_e_option, retro_f_option
FROM public.tc_axion_descarga

UNION ALL

SELECT 'CARGA',
id, base, fecha_transaccion, chofer, ronda, fecha_realizacion, hora_realizacion, patente, lugar, "Instructor", motivo, 
"1_sigue_procedimiento" AS P1, "1_observacion" AS P1_obs, "2_controla_plan_viaje" AS P2, "2_observacion" AS P2_obs, "3_apaga_luces" AS P3, "3_observacion" AS P3_obs, "4_posiciona_correctamente" AS P4, "4_observacion" AS P4_obs, "5_controla_freno_mano" AS P5, "5_observacion" AS P5_obs, "6_util_3_apoyo_salida" AS P6, "6_observacion" AS P6_obs, "7_util_epp" AS P7, "7_observacion" AS P7_obs, "8_desconecta_bateria" AS P8, "8_observacion" AS P8_obs, "9_procedi_local_drenado" AS P9, "9_observacion" AS P9_obs, "10_levanta_valvulas_API" AS P10, "10_observacion" AS P10_obs, "11_conecta_manguera" AS P11, "11_observacion" AS P11_obs, "12_quita_tapas_API" AS P12, "12_observacion" AS P12_obs, "13_controla_cisterna_vacia" AS P13, "13_observacion" AS P13_obs, "14_coloca_indicadores" AS P14, "14_observacion" AS P14_obs, "15_verifica_predeterminador" AS P15, "15_observacion" AS P15_obs, "16_conecta_brazo_carga" AS P16, "16_observacion" AS P16_obs, "17_util_posturas_correctas" AS P17, "17_observacion" AS P17_obs, "18_setea_medidores_exactos" AS P18, "18_observacion" AS P18_obs, "19_realiza_doble_chequeo" AS P19, "19_observacion" AS P19_obs, "20_foco_tarea" AS P20, "20_observacion" AS P20_obs, "21_controla_perdidas" AS P21, "21_observacion" AS P21_obs, "22_conoce_proce_emergencia" AS P22, "22_observacion" AS P22_obs, "23_cierra_valvula" AS P23, "23_observacion" AS P23_obs, "24_tapa_cisterna" AS P24, "24_observacion" AS P24_obs, "25_asegura_manguera" AS P25, "25_observacion" AS P25_obs, "26_asegura_cable" AS P26, "26_observacion" AS P26_obs, "27_completa_CDS" AS P27, "27_observacion" AS P27_obs, "28_realiza_vuelta_camion" AS P28, "28_observacion" AS P28_obs, "29_sube_3_apoyo" AS P29, "29_observacion" AS P29_obs, "30_conoc_proce_locales" AS P30, "30_observacion" AS P30_obs, "31_controla_documentos" AS P31, "31_observacion" AS P31_obs, "32_realiza_vuelta_camion_2" AS P32, "32_observacion" AS P32_obs, "33_sube_3_apoyo_2" AS P33, "33_observacion" AS P33_obs, "34_revisa_celular_apaga" AS P34, "34_observacion" AS P34_obs, "35_control_hoja_ruta" AS P35, "35_observacion" AS P35_obs, "36_prepara_salida" AS P36, "36_observacion" AS P36_obs, "37_asegura_trailer" AS P37, "37_observacion" AS P37_obs, "38_valvulas_emergencia" AS P38, "38_observacion" AS P38_obs, "39_asegura_valv_emergencia" AS P39, "39_observacion" AS P39_obs, "40_completa_control_calidad" AS P40, "40_observacion" AS P40_obs, "41_controla_cisternas" AS P41, "41_observacion" AS P41_obs, "42_conecta_cable_estatica" AS P42, "42_observacion" AS P42_obs, "43_indicador_productos" AS P43, "43_observacion" AS P43_obs, "44_controla_valvulas_fondo" AS P44, "44_observacion" AS P44_obs, "45_util_arnes" AS P45, "45_observacion" AS P45_obs, "46_inspecciona_cisterna" AS P46, "46_observacion" AS P46_obs, "47_controla_brazo_carga" AS P47, "47_observacion" AS P47_obs, "48_realiza_doble_chequeo" AS P48, "48_observacion" AS P48_obs, "49_chequea_flujo" AS P49, "49_observacion" AS P49_obs, "50_mantiene_vision" AS P50, "50_observacion" AS P50_obs, "51_asegura_brazo_postcarga" AS P51, "51_observacion" AS P51_obs, "52_cierra_tapas_cargadas" AS P52, "52_observacion" AS P52_obs, "53_asegura_descarga_estatica" AS P53, "53_observacion" AS P53_obs, "54_realiza_vuelta_camion_3" AS P54, "54_observacion" AS P54_obs, "55_completa_CDS_2" AS P55, "55_observacion" AS P55_obs, NULL AS P56, NULL AS P56_obs, NULL AS P57, NULL AS P57_obs, 
puntaje, estado, empresa_chofer, legajo_chofer, pregunta_13_principios, 13_princ_observacion, hora_inicio, hora_fin, adicional_ipv, retro_a, retro_b, retro_c, retro_d, retro_e, retro_f, retro_g, retro_h, retro_e_obs, retro_f_obs, retro_e_option, retro_f_option
FROM public.tc_axion_carga

  ) AS T
WHERE fecha_transaccion between %s and %s
ORDER BY fecha_transaccion desc
"""
